import { notFound } from "next/navigation";
import { Badge, CSC } from "@prisma/client";
import Menu from "@/components/menu";
import ClientSide from "@/components/clientSide";
import Content from "@/components/content";
import Container from "@/components/container";
import Map from "@/components/map";
import PRISMA from "../../../prisma";
import ContainerSSR from "@/components/containerSSR";

const states = {
  bayern: {
    zoom: 6.789326097705795,
    coord: { lng: 11.669835086111107, lat: 48.68684397029682 },
    bounds: [
      [8.9771580802, 47.2703623267],
      [13.8350427083, 50.5644529365],
    ],
    bbox: [
      [
        [8.9771580802, 47.2703623267],
        [13.8350427083, 47.2703623267],
        [13.8350427083, 50.5644529365],
        [8.9771580802, 50.5644529365],
        [8.9771580802, 47.2703623267],
      ],
    ],
  },
  niedersachsen: {
    zoom: 6.503239284125445,
    coord: { lng: 8.943599275322867, lat: 52.627810769839954 },
    bounds: [
      [6.6545841239, 51.2954150799],
      [11.59769814, 53.8941514415],
    ],
    bbox: [
      [
        [6.6545841239, 51.2954150799],
        [11.59769814, 51.2954150799],
        [11.59769814, 53.8941514415],
        [6.6545841239, 53.8941514415],
        [6.6545841239, 51.2954150799],
      ],
    ],
  },
  "baden-wuerttemberg": {
    zoom: 6.9299892993308045,
    coord: { lng: 8.902023340634514, lat: 48.77565798126918 },
    bounds: [
      [7.5113934084, 47.5338000528],
      [10.4918239143, 49.7913749328],
    ],
    bbox: [
      [
        [7.5113934084, 47.5338000528],
        [10.4918239143, 47.5338000528],
        [10.4918239143, 49.7913749328],
        [7.5113934084, 49.7913749328],
        [7.5113934084, 47.5338000528],
      ],
    ],
  },
  "nordrhein-westfalen": {
    zoom: 6.932008793512134,
    coord: { lng: 7.808262755417445, lat: 51.25758405670041 },
    bounds: [
      [5.8659988131, 50.3226989435],
      [9.4476584861, 52.5310351488],
    ],
    bbox: [
      [
        [5.8659988131, 50.3226989435],
        [9.4476584861, 50.3226989435],
        [9.4476584861, 52.5310351488],
        [5.8659988131, 52.5310351488],
        [5.8659988131, 50.3226989435],
      ],
    ],
  },
  brandenburg: {
    zoom: 6.637477044300535,
    coord: { lng: 13.351002316922632, lat: 52.51950593578741 },
    bounds: [
      [11.2681664447, 51.3606627053],
      [14.7647105012, 53.5579500214],
    ],
    bbox: [
      [
        [11.2681664447, 51.3606627053],
        [14.7647105012, 51.3606627053],
        [14.7647105012, 53.5579500214],
        [11.2681664447, 53.5579500214],
        [11.2681664447, 51.3606627053],
      ],
    ],
  },
  "mecklenburg-vorpommern": {
    zoom: 6.795091567664469,
    coord: { lng: 12.554044973166128, lat: 53.8820359697886 },
    bounds: [
      [10.5932460856, 53.1158637944],
      [14.4122799503, 54.684988683],
    ],
    bbox: [
      [
        [10.5932460856, 53.1158637944],
        [14.4122799503, 53.1158637944],
        [14.4122799503, 54.684988683],
        [10.5932460856, 54.684988683],
        [10.5932460856, 53.1158637944],
      ],
    ],
  },
  hessen: {
    zoom: 6.573859592145267,
    coord: { lng: 9.344026982989135, lat: 50.86431195832347 },
    bounds: [
      [7.7731704009, 49.3948229196],
      [10.2340156149, 51.6540496066],
    ],
    bbox: [
      [
        [7.7731704009, 49.3948229196],
        [10.2340156149, 49.3948229196],
        [10.2340156149, 51.6540496066],
        [7.7731704009, 51.6540496066],
        [7.7731704009, 49.3948229196],
      ],
    ],
  },
  "sachsen-anhalt": {
    zoom: 6.859657698518297,
    coord: { lng: 11.744893873001047, lat: 52.18966276925744 },
    bounds: [
      [10.56147554, 50.9379979829],
      [13.1865600846, 53.0421316033],
    ],
    bbox: [
      [
        [10.56147554, 50.9379979829],
        [13.1865600846, 50.9379979829],
        [13.1865600846, 53.0421316033],
        [10.56147554, 53.0421316033],
        [10.56147554, 50.9379979829],
      ],
    ],
  },
  "rheinland-pfalz": {
    zoom: 7.1658063405841625,
    coord: { lng: 7.750332741264856, lat: 50.10622418067865 },
    bounds: [
      [6.117359876, 48.9662745077],
      [8.5084754437, 50.9404435711],
    ],
    bbox: [
      [
        [6.117359876, 48.9662745077],
        [8.5084754437, 48.9662745077],
        [8.5084754437, 50.9404435711],
        [6.117359876, 50.9404435711],
        [6.117359876, 48.9662745077],
      ],
    ],
  },
  sachsen: {
    zoom: 7.1859246588348755,
    coord: { lng: 13.644012207862716, lat: 51.35593568950355 },
    bounds: [
      [11.8723081683, 50.1715419914],
      [15.0377433357, 51.6831408995],
    ],
    bbox: [
      [
        [11.8723081683, 50.1715419914],
        [15.0377433357, 50.1715419914],
        [15.0377433357, 51.6831408995],
        [11.8723081683, 51.6831408995],
        [11.8723081683, 50.1715419914],
      ],
    ],
  },
  thueringen: {
    zoom: 7.809345879020374,
    coord: { lng: 11.637450418479716, lat: 50.13219502292921 },
    bounds: [
      [9.8778443239, 50.2042330625],
      [12.6531964048, 51.6490678544],
    ],
    bbox: [
      [
        [9.8778443239, 50.2042330625],
        [12.6531964048, 50.2042330625],
        [12.6531964048, 51.6490678544],
        [9.8778443239, 51.6490678544],
        [9.8778443239, 50.2042330625],
      ],
    ],
  },
  "schleswig-holstein": {
    zoom: 7.4734530043882685,
    coord: { lng: 9.811052796273088, lat: 54.300853684948805 },
    bounds: [
      [7.868514562, 53.3590675115],
      [11.3132037822, 55.0573747014],
    ],
    bbox: [
      [
        [7.868514562, 53.3590675115],
        [11.3132037822, 53.3590675115],
        [11.3132037822, 55.0573747014],
        [7.868514562, 55.0573747014],
        [7.868514562, 53.3590675115],
      ],
    ],
  },
  saarland: {
    zoom: 9.130632251279744,
    coord: { lng: 6.993319771427878, lat: 49.38590840719138 },
    bounds: [
      [6.3584695643, 49.1130992988],
      [7.4034901078, 49.6393467247],
    ],
    bbox: [
      [
        [6.3584695643, 49.1130992988],
        [7.4034901078, 49.1130992988],
        [7.4034901078, 49.6393467247],
        [6.3584695643, 49.6393467247],
        [6.3584695643, 49.1130992988],
      ],
    ],
  },
};

const cities = {
  berlin: {
    zoom: 9.155684245593005,
    coord: { lng: 13.46600306886944, lat: 52.48914504890078 },
    bounds: [
      [13.0882097323, 52.3418234221],
      [13.7606105539, 52.6697240587],
    ],
    bbox: [
      [
        [13.0882097323, 52.3418234221],
        [13.7606105539, 52.3418234221],
        [13.7606105539, 52.6697240587],
        [13.0882097323, 52.6697240587],
        [13.0882097323, 52.3418234221],
      ],
    ],
  },
  hamburg: {
    zoom: 9.476986896646547,
    coord: { lng: 10.040357864981729, lat: 53.578686529639356 },
    bounds: [
      [8.4213643278, 53.3949251389],
      [10.3242585128, 53.9644376366],
    ],
    bbox: [
      [
        [8.4213643278, 53.3949251389],
        [10.3242585128, 53.3949251389],
        [10.3242585128, 53.9644376366],
        [8.4213643278, 53.9644376366],
        [8.4213643278, 53.3949251389],
      ],
    ],
  },
  bremen: {
    zoom: 9.90178953287289,
    coord: { lng: 8.887546505725481, lat: 53.054120094701375 },
    bounds: [
      [8.4813576818, 53.0103701114],
      [8.9830477728, 53.6061664164],
    ],
    bbox: [
      [
        [8.4813576818, 53.0103701114],
        [8.9830477728, 53.0103701114],
        [8.9830477728, 53.6061664164],
        [8.4813576818, 53.6061664164],
        [8.4813576818, 53.0103701114],
      ],
    ],
  },
  muenchen: {
    zoom: 9.370035663878676,
    coord: { lng: 11.60141857763233, lat: 48.14542685359277 },
    bounds: [
      [11.288181483085935, 48.074632723106504],
      [11.83830079933199, 48.285211905656155],
    ],
  },
  koeln: {
    zoom: 10.037822801215718,
    coord: { lng: 7.002641347892109, lat: 50.94302519614243 },
    bounds: [
      [6.722133027356762, 50.80784675681204],
      [7.116732768618249, 51.04791055366209],
    ],
  },
  "frankfurt-am-main": {
    zoom: 9.736198030656908,
    coord: { lng: 8.680061141909732, lat: 50.119335250778676 },
    bounds: [
      [8.582194606684482, 50.0841930229291],
      [8.73290709811559, 50.16427051654776],
    ],
  },
  stuttgart: {
    zoom: 9.73037413665526,
    coord: { lng: 9.256931438834727, lat: 48.81291800600604 },
    bounds: [
      [9.138780272335737, 48.75400264397962],
      [9.23810717194533, 48.84527726151285],
    ],
  },
  duesseldorf: {
    zoom: 10.63789903795318,
    coord: { lng: 6.814954855352198, lat: 51.21423290567705 },
    bounds: [
      [6.683531483827238, 51.179793191328656],
      [6.8665528033717464, 51.29371722372011],
    ],
  },
  leipzig: {
    zoom: 10.695134257565305,
    coord: { lng: 12.426738447290859, lat: 51.34056128577873 },
    bounds: [
      [12.225877061533481, 51.273623347149424],
      [12.502189187242237, 51.41987086719112],
    ],
  },
  dortmund: {
    zoom: 10.484448125516462,
    coord: { lng: 7.503407356960452, lat: 51.51832040180989 },
    bounds: [
      [7.352860480507559, 51.46328712769096],
      [7.5588759217324935, 51.56600215029732],
    ],
  },
  essen: {
    zoom: 11.9108006398796141,
    coord: { lng: 7.04088834901961, lat: 51.455158539259855 },
    bounds: [
      [6.924748268792683, 51.423073801231624],
      [7.0834650341003, 51.49312392761047],
    ],
  },
};

interface PageProps {
  params: {
    area: string;
  };
}
export default async function Page(props: PageProps) {
  if (
    !Object.keys(states).includes(props.params.area) &&
    !Object.keys(cities).includes(props.params.area)
  ) {
    notFound();
  }
  let bounds: [[number, number], [number, number]] = [
    [0, 0],
    [0, 0],
  ];
  const cscs = await PRISMA.cSC.findMany({
    include: {
      badges: true,
    },
  });
  let relevantCSCs: (CSC & { badges: Badge[] })[] = [];

  const state = states[props.params.area as "hessen"];
  if (state) {
    relevantCSCs = cscs.filter((csc) => csc.state === props.params.area);
    if (state.bounds) {
      bounds = state.bounds as [[number, number], [number, number]];
    }
  }

  const city = cities[props.params.area as "berlin"];
  if (city) {
    relevantCSCs = cscs.filter((csc) => csc.city === props.params.area);
    if (city.bounds) {
      bounds = city.bounds as [[number, number], [number, number]];
    }
  }

  return (
    <div className="flex h-full w-full">
      <Menu />
      <main className="block h-full w-full">
        <ClientSide>
          <Content seenIntro={true} />
        </ClientSide>

        <ContainerSSR entries={relevantCSCs} />
        <div className="w-full h-full relative bg-green-700 pt-10 px-2.5 text-white block md:flex overflow-hidden">
          <Container entries={cscs} />
          <Map entries={cscs} bounds={bounds} />
        </div>
      </main>
    </div>
  );
}
